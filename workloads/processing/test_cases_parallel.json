{
  "configuration": {
    "short_tasks": 39,
    "long_tasks": 1,
    "total_tasks": 40
  },
  "test_cases": [
    {
      "id": "pigz_compression",
      "name": "Pigz Directory Compression",
      "description": "Parallel compression of mixed-size files with severe load imbalance",
      "category": "file_processing",
      "setup_commands": [
        "mkdir -p test_data",
        "seq 1 150000 > test_data/short_file.dat",
        "seq 1 4000000 > test_data/large_file.dat"
      ],
      "small_commands": [
        "pigz -1 test_data/short_file.dat"
      ],
      "large_commands": [
        "pigz -1 test_data/large_file.dat"
      ],
      "test_command": "find ./test_data -name '*.dat' -o -name '*.iso' -print0 | xargs -0 -n1 -P2 pigz -1",
      "cleanup_commands": [
        "rm -rf test_data/",
        "rm -f *.gz"
      ],
      "expected_improvement": 0.33,
      "dependencies": ["pigz"]
    },
    {
      "id": "ffmpeg_transcode",
      "name": "FFmpeg Split Transcode",
      "description": "Video transcoding with one large file dominating processing time",
      "category": "media_processing",
      "setup_commands": [
        "mkdir -p clips out",
        "ffmpeg -f lavfi -i testsrc=duration=1:size=320x240:rate=30 -loglevel quiet clips/short.mp4",
        "ffmpeg -f lavfi -i testsrc=duration=5:size=1920x1080:rate=30 -loglevel quiet clips/long.mp4"
      ],
      "small_commands": [
        "ffmpeg -loglevel quiet -i clips/short.mp4 -vf scale=640:-1 -c:v libx264 -preset veryfast out/short_out.mp4"
      ],
      "large_commands": [
        "ffmpeg -loglevel quiet -i clips/long.mp4 -vf scale=640:-1 -c:v libx264 -preset veryfast out/long_out.mp4"
      ],
      "test_command": "for f in clips/*.mp4; do ffmpeg -loglevel quiet -i \"$f\" -vf scale=640:-1 -c:v libx264 -preset veryfast out/\"${f##*/}\" & done; wait",
      "cleanup_commands": [
        "rm -rf clips/ out/"
      ],
      "expected_improvement": 0.33,
      "dependencies": ["ffmpeg"]
    },
    {
      "id": "c_compile_suite",
      "name": "C Compilation Suite with Complex Project",
      "description": "Compile suite with fast simple programs and one complex project",
      "category": "software_compilation",
      "setup_commands": [
        "mkdir -p c_suite",
        "echo '#include <stdio.h>\n#include <math.h>\nint main() { double sum=0; int n=500000; while(n--) { sum += sin(n*0.001)*cos(n*0.001); } printf(\"Short: %f\\n\", sum); return 0; }' > c_suite/short.c",
        "echo '#include <stdio.h>\n#include <stdlib.h>\n#include <math.h>\nint main() { double sum=0; int n=2500000; while(n--) { double x = n*0.0001; sum += sin(x)*cos(x)*sqrt(x+1); } printf(\"Long: %f\\n\", sum); return 0; }' > c_suite/long.c"
      ],
      "small_commands": [
        "gcc -O2 c_suite/short.c -o c_suite/short && c_suite/short > /dev/null"
      ],
      "large_commands": [
        "gcc -O2 c_suite/long.c -lm -o c_suite/long && c_suite/long > /dev/null"
      ],
      "test_command": "cd c_suite && for f in *.c; do gcc -O2 \"$f\" -lm -o \"${f%.c}\" && \"${f%.c}\" & done; wait",
      "cleanup_commands": [
        "rm -rf c_suite/"
      ],
      "expected_improvement": 0.33,
      "dependencies": ["gcc"]
    },
    {
      "id": "git_compression",
      "name": "Git Incremental Compression",
      "description": "Git garbage collection with mixed object sizes",
      "category": "version_control",
      "setup_commands": [
        "rm -rf test_repo && mkdir -p test_repo && cd test_repo && git init",
        "cd test_repo && git config user.name 'Test User' && git config user.email 'test@example.com'",
        "cd test_repo && echo 'small change' > small_file.txt && git add small_file.txt && git commit -m 'small commit' --quiet",
        "cd test_repo && dd if=/dev/urandom of=large.bin bs=1M count=300 2>/dev/null && git add large.bin && git commit -m 'add large binary' --quiet"
      ],
      "small_commands": [
        "cd test_repo && git log --oneline -n 5 > /tmp/short_log.txt && sha256sum /tmp/short_log.txt"
      ],
      "large_commands": [
        "cd test_repo && echo \"Processing large repository\" && git repack -a -d -f --depth=50 --window=250"
      ],
      "test_command": "cd test_repo && time git gc",
      "cleanup_commands": [
        "rm -rf test_repo/"
      ],
      "expected_improvement": 0.30,
      "dependencies": ["git"]
    },
    {
      "id": "file_checksum",
      "name": "Parallel File System Operations",
      "description": "Checksum operations with one large file blocking completion",
      "category": "file_processing",
      "setup_commands": [
        "mkdir -p large-dir",
        "dd if=/dev/urandom of=large-dir/short_file.dat bs=1M count=5 2>/dev/null",
        "dd if=/dev/urandom of=large-dir/long_file.dat bs=1M count=100 2>/dev/null"
      ],
      "small_commands": [
        "sha256sum large-dir/short_file.dat"
      ],
      "large_commands": [
        "sha256sum large-dir/long_file.dat"
      ],
      "test_command": "find ./large-dir -type f -print0 | xargs -0 -n1 -P2 sha256sum > checksums.txt",
      "cleanup_commands": [
        "rm -rf large-dir/",
        "rm -f checksums.txt"
      ],
      "expected_improvement": 0.33,
      "dependencies": ["sha256sum"]
    },
    {
      "id": "sort_compress",
      "name": "Sort and Compress with Skew",
      "description": "Log processing with one large chunk among small ones",
      "category": "data_processing",
      "setup_commands": [
        "seq 1 10000 | shuf > short_part.tsv",
        "seq 1 500000 | shuf > long_part.tsv"
      ],
      "small_commands": [
        "sort short_part.tsv | zstd -q -o short_part.tsv.zst"
      ],
      "large_commands": [
        "sort long_part.tsv | zstd -q -o long_part.tsv.zst"
      ],
      "test_command": "parallel -j2 --line-buffer 'sort {} | zstd -q -o {}.zst' ::: part_*.tsv",
      "cleanup_commands": [
        "rm -f part_*.tsv part_*.tsv.zst"
      ],
      "expected_improvement": 0.30,
      "dependencies": ["parallel", "zstd"]
    },
    {
      "id": "spark_shuffle",
      "name": "Spark Local Shuffle with Skew",
      "description": "Analytics with skewed data distribution (hot key problem)",
      "category": "data_processing",
      "setup_commands": [
        "chmod +x assets/spark_skew_test.py",
        "mkdir -p spark_data",
        "seq 1 100000 > spark_data/short_data.txt",
        "seq 1 500000 > spark_data/long_data.txt"
      ],
      "small_commands": [
        "sha256sum spark_data/short_data.txt | cut -d' ' -f1 > /tmp/short_hash.txt"
      ],
      "large_commands": [
        "sha256sum spark_data/long_data.txt | cut -d' ' -f1 > /tmp/long_result.txt"
      ],
      "test_command": "python3 assets/spark_skew_test.py",
      "cleanup_commands": [
        "rm -rf spark_data/"
      ],
      "expected_improvement": 0.33,
      "dependencies": ["python3"]
    },
    {
      "id": "log_analysis",
      "name": "Log Analysis with Heavy Processing",
      "description": "Log processing with grep/awk analysis and one complex computation",
      "category": "data_processing",
      "setup_commands": [
        "mkdir -p logs",
        "seq 1 10000 | awk '{print strftime(\"%Y-%m-%d %H:%M:%S\"), \"INFO\", \"Message\", $1}' | gzip > logs/short_log.gz",
        "seq 1 500000 | awk '{print strftime(\"%Y-%m-%d %H:%M:%S\"), \"INFO\", \"Message\", $1}' | gzip > logs/long_log.gz"
      ],
      "small_commands": [
        "zcat logs/short_log.gz | grep -c 'INFO'"
      ],
      "large_commands": [
        "zcat logs/long_log.gz | awk '{count[$2]++} END {for(i in count) print i, count[i]}' | sort -nr | sha256sum > /tmp/analysis_result"
      ],
      "test_command": "for f in logs/*.gz; do zcat \"$f\" | wc -l & done; wait",
      "cleanup_commands": [
        "rm -rf logs/",
        "rm -f /tmp/analysis_result"
      ],
      "expected_improvement": 0.35,
      "dependencies": ["gzip", "awk", "grep"]
    },
    {
      "id": "text_processing",
      "name": "Text Processing with Complex Analysis",
      "description": "Text analysis with simple grep and one complex sed/awk pipeline",
      "category": "data_processing",
      "setup_commands": [
        "mkdir -p text_data",
        "seq 1 10000 | awk '{printf \"key_short,value_%d\\n\", $1}' > text_data/short_file.txt",
        "seq 1 250000 | awk '{printf \"key_long,value_%d\\n\", $1}' > text_data/long_file.txt"
      ],
      "small_commands": [
        "grep -c 'key' text_data/short_file.txt"
      ],
      "large_commands": [
        "cat text_data/long_file.txt | awk -F',' '{count[$1]++; sum[$1]+=$2} END {for(k in count) printf \"%s:%d:%s\\n\", k, count[k], sum[k]}' | sed 's/:/|/g' | sha256sum > /tmp/complex_result"
      ],
      "test_command": "for f in text_data/*.txt; do wc -l \"$f\" & done; wait",
      "cleanup_commands": [
        "rm -rf text_data/",
        "rm -f /tmp/complex_result"
      ],
      "expected_improvement": 0.30,
      "dependencies": ["grep", "awk", "sed"]
    }
  ],
  "metadata": {
    "version": "2.1",
    "description": "Long-tail workload test cases with system-level parallel commands",
    "target_platform": "Linux",
    "cpu_count": 4,
    "total_test_cases": 10,
    "average_expected_improvement": 0.32
  }
}